(function(){var f,h,g,i,j,c,k,e,n=Object.prototype.hasOwnProperty,m=function(b,a){function l(){this.constructor=b}for(var d in a)n.call(a,d)&&(b[d]=a[d]);l.prototype=a.prototype;b.prototype=new l;b.__super__=a.prototype;return b};k=require("pebblecore");e=require("underscore");require("jquery");g=require("backbone");c=e.extend({},g);h=function(b,a){if(!b.hasOwnProperty(a))throw Error("Invalid namespace for collection "+this.constructor.name+': "'+a+'" (missing key in response)');return!0};f=function(b){function a(){a.__super__.constructor.apply(this,
arguments)}m(a,b);a.prototype.parse=function(a){var d;return(d=this.namespace)&&h(a,d)?a[d]:a};a.prototype.toJSON=function(){var a,d,b;d=this.namespace;a=e.clone(this.attributes);return d?(b={},b[d]=a,b):a};a.prototype.getAttributes=function(){return e.clone(this.attributes)};return a}(g.Model);c.Model=f;f=function(b){function a(){a.__super__.constructor.apply(this,arguments)}m(a,b);a.prototype.parse=function(a){var b,c,e,f,g;(b=this.namespace)&&h(a,b)&&(a=a[b]);c=this.model.prototype.namespace;e=
[];if(c)for(f=0,g=a.length;f<g;f++)b=a[f],h(b,c),null!==b[c]&&e.push(b[c]);return e};a.prototype.toJSON=function(){return e.clone(this.attributes)};a.prototype.getAttributes=function(){return this.map(function(a){return a.getAttributes()})};return a}(g.Collection);c.Collection=f;c.VERSION+=".pebbles";j={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};i=function(b){return!b||!b.url?null:e.isFunction(b.url)?b.url():b.url};c.sync=function(b,a,c){var d;d={};if(!c.data&&a&&("create"===b||"update"===
b))d["Content-Type"]="application/json",c.data=JSON.stringify(a.toJSON());return k.connector.perform(j[b],i(a),c.data,d).then(c.success,c.error)};"undefined"!==typeof exports&&null!==exports?e.extend(exports,c):(this.pebbles||(this.pebbles={})).backbone=c}).call(this);
